<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DS Button Sprite Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 20px auto;
            padding: 20px;
            background: #2c3e50;
            color: white;
        }
        .controls {
            background: #34495e;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .control-group {
            margin-bottom: 15px;
        }
        label {
            display: inline-block;
            width: 140px;
            font-weight: bold;
        }
        input[type="text"], input[type="color"], select {
            padding: 5px;
            border-radius: 4px;
            border: 1px solid #7f8c8d;
            width: 200px;
        }
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #2980b9;
        }
        .canvas-container {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        canvas {
            border: 2px solid #95a5a6;
            image-rendering: pixelated;
            image-rendering: crisp-edges;
        }
        .preview {
            margin-top: 20px;
        }
        .info {
            background: #16a085;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }
        .scale-controls {
            margin-top: 10px;
        }
        .font-preview {
            background: #34495e;
            padding: 10px;
            margin-top: 10px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>ðŸŽ® Nintendo DS Button Sprite Generator</h1>
    
    <div class="controls">
        <div class="control-group">
            <label>Button Text:</label>
            <input type="text" id="buttonText" value="SINGLE PLAYER">
        </div>
        <div class="control-group">
            <label>Button Color:</label>
            <input type="color" id="buttonColor" value="#4a90e2">
        </div>
        <div class="control-group">
            <label>Text Color:</label>
            <input type="color" id="textColor" value="#ffffff">
        </div>
        <div class="control-group">
            <label>Border Color:</label>
            <input type="color" id="borderColor" value="#2c5aa0">
        </div>
        <div class="control-group">
            <label>Font Size:</label>
            <input type="text" id="fontSize" value="8" style="width: 50px;"> px (recommended: 6-10)
        </div>
        <div class="control-group">
            <label>Border Width:</label>
            <input type="text" id="borderWidth" value="2" style="width: 50px;"> px
        </div>
        <button onclick="generateButton()">Generate Button</button>
        <button onclick="downloadButton()">Download PNG</button>
    </div>

    <div class="canvas-container">
        <h3>Preview (Actual Size: 64x96)</h3>
        <canvas id="buttonCanvas" width="64" height="96"></canvas>
        
        <div class="scale-controls">
            <label>Preview Scale:</label>
            <input type="range" id="scaleSlider" min="2" max="8" value="6" oninput="updateScale()">
            <span id="scaleValue">6x</span>
        </div>
        
        <div class="preview">
            <p><strong>Three frames stacked vertically:</strong></p>
            <p>Frame 0 (0-31px): Normal state</p>
            <p>Frame 1 (32-63px): Highlighted state</p>
            <p>Frame 2 (64-95px): Pressed state</p>
        </div>
        
        <div class="font-preview">
            <p><strong>ðŸ’¡ Note:</strong> This generator always uses Pixel Perfect mode for crisp DS graphics. Adjust font size (6-10) to fit your text.</p>
        </div>
    </div>

    <div class="info">
        <h3>ðŸ“‹ How to Use:</h3>
        <ol>
            <li>Customize your button using the controls above</li>
            <li>Use "Pixel Perfect" font for cleanest results on DS hardware</li>
            <li>Click "Generate Button" to preview</li>
            <li>Click "Download PNG" to save the sprite</li>
            <li>Use GRIT to convert: <code>grit your_button.png -gB8 -gT FF00FF -gt -gzl -m! -p!</code></li>
            <li>Include the generated .h file in your DS project</li>
        </ol>
        <p><strong>Note:</strong> The magenta (#FF00FF) background will become transparent when processed by GRIT.</p>
        <p><strong>Font sizes:</strong> 6px works for short text, 8px is standard, 10px for titles. Keep text short!</p>
    </div>

    <script>
        const canvas = document.getElementById('buttonCanvas');
        const ctx = canvas.getContext('2d');

        // Pixel-perfect font drawing
        const pixelFont = {
            'A': [[0,1,1,0],[1,0,0,1],[1,1,1,1],[1,0,0,1],[1,0,0,1]],
            'B': [[1,1,1,0],[1,0,0,1],[1,1,1,0],[1,0,0,1],[1,1,1,0]],
            'C': [[0,1,1,1],[1,0,0,0],[1,0,0,0],[1,0,0,0],[0,1,1,1]],
            'D': [[1,1,1,0],[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,1,1,0]],
            'E': [[1,1,1,1],[1,0,0,0],[1,1,1,0],[1,0,0,0],[1,1,1,1]],
            'F': [[1,1,1,1],[1,0,0,0],[1,1,1,0],[1,0,0,0],[1,0,0,0]],
            'G': [[0,1,1,1],[1,0,0,0],[1,0,1,1],[1,0,0,1],[0,1,1,1]],
            'H': [[1,0,0,1],[1,0,0,1],[1,1,1,1],[1,0,0,1],[1,0,0,1]],
            'I': [[1,1,1],[0,1,0],[0,1,0],[0,1,0],[1,1,1]],
            'J': [[0,0,1],[0,0,1],[0,0,1],[1,0,1],[0,1,0]],
            'K': [[1,0,0,1],[1,0,1,0],[1,1,0,0],[1,0,1,0],[1,0,0,1]],
            'L': [[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,1,1,1]],
            'M': [[1,0,0,0,1],[1,1,0,1,1],[1,0,1,0,1],[1,0,0,0,1],[1,0,0,0,1]],
            'N': [[1,0,0,1],[1,1,0,1],[1,0,1,1],[1,0,0,1],[1,0,0,1]],
            'O': [[0,1,1,0],[1,0,0,1],[1,0,0,1],[1,0,0,1],[0,1,1,0]],
            'P': [[1,1,1,0],[1,0,0,1],[1,1,1,0],[1,0,0,0],[1,0,0,0]],
            'Q': [[0,1,1,0],[1,0,0,1],[1,0,0,1],[1,0,1,0],[0,1,0,1]],
            'R': [[1,1,1,0],[1,0,0,1],[1,1,1,0],[1,0,1,0],[1,0,0,1]],
            'S': [[0,1,1,1],[1,0,0,0],[0,1,1,0],[0,0,0,1],[1,1,1,0]],
            'T': [[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0]],
            'U': [[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[0,1,1,0]],
            'V': [[1,0,0,0,1],[1,0,0,0,1],[0,1,0,1,0],[0,1,0,1,0],[0,0,1,0,0]],
            'W': [[1,0,0,0,1],[1,0,0,0,1],[1,0,1,0,1],[1,1,0,1,1],[1,0,0,0,1]],
            'X': [[1,0,0,0,1],[0,1,0,1,0],[0,0,1,0,0],[0,1,0,1,0],[1,0,0,0,1]],
            'Y': [[1,0,0,0,1],[0,1,0,1,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0]],
            'Z': [[1,1,1,1],[0,0,0,1],[0,0,1,0],[0,1,0,0],[1,1,1,1]],
            ' ': [[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],
        };

        function drawPixelChar(x, y, char, color, scale = 1) {
            const pattern = pixelFont[char.toUpperCase()];
            if (!pattern) return 0;
            
            for (let row = 0; row < pattern.length; row++) {
                for (let col = 0; col < pattern[row].length; col++) {
                    if (pattern[row][col]) {
                        ctx.fillStyle = color;
                        ctx.fillRect(x + col * scale, y + row * scale, scale, scale);
                    }
                }
            }
            return pattern[0].length * scale + scale; // Width + spacing
        }

        function drawPixelText(x, y, text, color, scale = 1) {
            let offsetX = 0;
            for (let i = 0; i < text.length; i++) {
                offsetX += drawPixelChar(x + offsetX, y, text[i], color, scale);
            }
            return offsetX;
        }

        function drawRoundedRect(ctx, x, y, width, height, radius, fill, stroke, lineWidth) {
            ctx.beginPath();
            ctx.moveTo(x + radius, y);
            ctx.lineTo(x + width - radius, y);
            ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
            ctx.lineTo(x + width, y + height - radius);
            ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
            ctx.lineTo(x + radius, y + height);
            ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
            ctx.lineTo(x, y + radius);
            ctx.quadraticCurveTo(x, y, x + radius, y);
            ctx.closePath();
            
            if (fill) {
                ctx.fillStyle = fill;
                ctx.fill();
            }
            if (stroke) {
                ctx.strokeStyle = stroke;
                ctx.lineWidth = lineWidth || 1;
                ctx.stroke();
            }
        }

        function generateButton() {
            const buttonText = document.getElementById('buttonText').value;
            const buttonColor = document.getElementById('buttonColor').value;
            const textColor = document.getElementById('textColor').value;
            const borderColor = document.getElementById('borderColor').value;
            const fontSize = parseInt(document.getElementById('fontSize').value);
            const borderWidth = parseInt(document.getElementById('borderWidth').value);

            // Clear canvas with magenta (transparent color for DS)
            ctx.fillStyle = '#FF00FF';
            ctx.fillRect(0, 0, 64, 96);

            // Disable image smoothing for pixel-perfect rendering
            ctx.imageSmoothingEnabled = false;

            // Frame 0: Normal state (y: 0-31)
            drawFrame(0, buttonColor, textColor, borderColor, buttonText, fontSize, borderWidth, 0);

            // Frame 1: Highlighted state (y: 32-63) - brighter
            const highlightColor = lightenColor(buttonColor, 20);
            drawFrame(32, highlightColor, textColor, borderColor, buttonText, fontSize, borderWidth + 1, 0);

            // Frame 2: Pressed state (y: 64-95) - darker and shifted
            const pressedColor = darkenColor(buttonColor, 20);
            drawFrame(64, pressedColor, textColor, borderColor, buttonText, fontSize, borderWidth, 1);
        }

        function drawFrame(yOffset, bgColor, txtColor, brdColor, text, fontSize, borderWidth, shift) {
            const padding = 4;
            const x = padding;
            const y = yOffset + padding + shift;
            const width = 64 - (padding * 2);
            const height = 32 - (padding * 2);

            // Draw button background
            drawRoundedRect(ctx, x, y, width, height, 4, bgColor, brdColor, borderWidth);

            // Always use pixel-perfect font
            const scale = Math.max(1, Math.floor(fontSize / 5));
            const words = text.split(' ');
            let currentY = y + height / 2 - (words.length * 6 * scale) / 2;
            
            words.forEach(word => {
                const textWidth = word.length * (5 * scale);
                const textX = x + width / 2 - textWidth / 2;
                drawPixelText(textX, currentY, word, txtColor, scale);
                currentY += 6 * scale;
            });
        }

        function lightenColor(color, percent) {
            const num = parseInt(color.replace("#", ""), 16);
            const amt = Math.round(2.55 * percent);
            const R = Math.min(255, (num >> 16) + amt);
            const G = Math.min(255, (num >> 8 & 0x00FF) + amt);
            const B = Math.min(255, (num & 0x0000FF) + amt);
            return "#" + (0x1000000 + R * 0x10000 + G * 0x100 + B).toString(16).slice(1);
        }

        function darkenColor(color, percent) {
            const num = parseInt(color.replace("#", ""), 16);
            const amt = Math.round(2.55 * percent);
            const R = Math.max(0, (num >> 16) - amt);
            const G = Math.max(0, (num >> 8 & 0x00FF) - amt);
            const B = Math.max(0, (num & 0x0000FF) - amt);
            return "#" + (0x1000000 + R * 0x10000 + G * 0x100 + B).toString(16).slice(1);
        }

        function downloadButton() {
            const link = document.createElement('a');
            const buttonText = document.getElementById('buttonText').value.toLowerCase().replace(/\s+/g, '_');
            link.download = `button_${buttonText}.png`;
            link.href = canvas.toDataURL();
            link.click();
        }

        function updateScale() {
            const scale = document.getElementById('scaleSlider').value;
            document.getElementById('scaleValue').textContent = scale + 'x';
            canvas.style.width = (64 * scale) + 'px';
            canvas.style.height = (96 * scale) + 'px';
        }

        // Initial generation
        generateButton();
        updateScale();
    </script>
</body>
</html>